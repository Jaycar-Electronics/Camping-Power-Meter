
#ifndef _HTML_H__
#define _HTML_H__
const char indexhtml[] PROGMEM = "<!DOCTYPE HTML><html><head><title>Camping Current Meter</title><meta name='viewport' content='width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0'><script>window.onload=function(){var time_scale=10;var data_len=50;var t_res=time_scale/data_len;var datapoints=[];for(i=0;i<data_len;i++){datapoints.push(0);}var reading_span=document.getElementById('reading');var average_span=document.getElementById('average');var seconds_span=document.getElementById('sec');seconds_span.innerText=time_scale;var log=document.getElementById('log');var canvas=document.getElementById('chart');var ctx=canvas.getContext('2d');var avg=0;function asyncRead(url,func){func(5+Math.random()*2);}function updateData(data){datapoints.push(data);datapoints.shift();var sum=0;for(var i=0;i<datapoints.length;i++){sum+=parseInt(datapoints[i],10);}avg=sum/datapoints.length;updatePage(data);}function updatePage(data){reading_span.innerText=data.toFixed(3);average_span.innerText=avg;var dist=canvas.width/data_len;ctx.clearRect(0,0,canvas.width,canvas.height);ctx.strokeStyle='#0000FF';ctx.moveTo(0,0);ctx.beginPath();p=0;datapoints.forEach(function(value){ctx.lineTo(p,canvas.height -(value*10));p+=dist;});ctx.stroke();}setInterval(function(){asyncRead('current',updateData)},t_res*1000);var button=document.getElementById('capture');button.onclick=function(){var d=new Date();var dateString=('0'+d.getHours()).slice(-2)+':'+('0'+d.getMinutes()).slice(-2)+':'+('0'+d.getSeconds()).slice(-2)+' '+d.getFullYear()+'/'+('0'+(d.getMonth()+1)).slice(-2)+'/'+('0'+d.getDate()).slice(-2);var innerText='Reading: '+datapoints.slice(-1)[0].toFixed(3)+' at '+dateString+'\n';log.value=innerText+log.value;};var checkbox=document.getElementById('checkbox');checkbox.onclick=function(){if(checkbox.checked==true){checkbox_interval=setInterval(function(){button.onclick();},500);}else{console.log('UNCHECKED');clearInterval(checkbox_interval);}}}</script><style>textarea{margin-top: 10px;}h1,h2,h3,p{font-family: 'Arial Black',Gadget,sans-serif;color: darkblue;}span{color: red;}.form>button,textarea{border: 1px solid darkblue;}</style></head><body><center><h1>Jaycar</h1><h1>Current reading:<span id='reading'>0</span></h1><h2>Average over<span id='sec'></span>seconds:<span id='average'>0</span></h2><canvas id='chart' width='300px;' height='100px;' style='border: 1px solid black;'></canvas><div class='form'><button id='capture'>Capture</button><input type='checkbox' id='checkbox'>Auto-log</input><button id='copier'>Copy to clipboard</button><br/><textarea id='log' cols='40' rows='60' readonly='true'></textarea></div></center></body></html>"; 
#endif
